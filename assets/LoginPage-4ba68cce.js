import{O as f,P,Q as y,S as i,U as B,V as I,k as S,b as T,u as x,c as v,r as b,R as E,j as t,M,W as H,A as h,X as d,Y as L,I as R,B as F,Z as O,d as G}from"./index-42261306.js";const{LOGIN:k}=P,{AUTH:D}=y;class z{static async setLogin({email:s,password:n}){return(await f.post(`${D}${k}`,{email:s,password:n})).data}}function w({email:a,password:s}){return async function(n){n({type:i.AUTH_PENDING,payload:!0});const o=await z.setLogin({email:a,password:s});if(typeof o=="string"){n({type:i.AUTH_ERROR,payload:o});return}n({type:i.AUTH_SUCCESS,payload:o==null?void 0:o.user}),localStorage.setItem("token",o.accessToken),localStorage.setItem("refreshToken",o.refreshToken)}}var g=(a=>(a[a.MAX_PASSWORD_LENGTH=16]="MAX_PASSWORD_LENGTH",a[a.MIN_PASSWORD_LENGTH=6]="MIN_PASSWORD_LENGTH",a))(g||{}),_=(a=>(a.INVALID_EMAIL="Invalid email",a.MAX_LENGTH="Must be at most 16 characters",a.MIN_LENGTH="Must be at least 6 characters",a))(_||{});const U=B().shape({email:I().email(_.INVALID_EMAIL).required(S.REQUIRED_FIELD),password:I().max(g.MAX_PASSWORD_LENGTH,_.MAX_LENGTH).min(g.MIN_PASSWORD_LENGTH,_.MIN_LENGTH).required(S.REQUIRED_FIELD)}),W="_authForm_3zb5r_1",X="_authFieldContainer_3zb5r_6",$="_authInputContainer_3zb5r_12",Q="_authFieldError_3zb5r_19",q="_authLabel_3zb5r_23",Y="_authInput_3zb5r_12",Z="_authFormNavigationContainer_3zb5r_39",J="_formButton_3zb5r_43",K="_authButton_3zb5r_51",V="_resetButton_3zb5r_55",tt="_testError_3zb5r_60",e={authForm:W,authFieldContainer:X,authInputContainer:$,authFieldError:Q,authLabel:q,authInput:Y,authFormNavigationContainer:Z,formButton:J,authButton:K,resetButton:V,testError:tt},at=()=>{const a=T(),s=x(),{error:n,isPending:o,user:m}=v(r=>r.authReducer);b.useEffect(()=>{m!=null&&m.id&&localStorage.getItem("token")&&s(E.HOME),a({type:i.RESET_ERROR})},[m]);const C=async r=>{a(w({...r}))},j=r=>{r(),a({type:i.RESET_ERROR})};return t.jsx("form",{className:e.authForm,children:o?t.jsx(M,{}):t.jsx(H,{initialValues:{email:"",password:""},validationSchema:U,onSubmit:C,children:({handleSubmit:r,handleBlur:N,resetForm:A})=>t.jsxs("div",{className:e.authFieldContainer,children:[t.jsx("span",{className:h(d.modalError,e.authFieldError,e.testError),children:n}),t.jsx(L,{name:"email",children:({field:l,meta:c})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"email",children:"Email"}),t.jsx(R,{...l,className:e.authInput,id:"email",type:"email",placeholder:"Email",onBlur:u=>{l.onBlur(u),N(u)}}),t.jsx("span",{className:h(d.modalError,e.authFieldError),children:c.touched&&c.error})]})}),t.jsx(L,{name:"password",children:({field:l,meta:c})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"password",children:"Password"}),t.jsx(R,{...l,className:e.authInput,type:"password",id:"password",placeholder:"Password",onBlur:u=>{l.onBlur(u),N(u)}}),t.jsx("span",{className:h(d.modalError,e.authFieldError),children:c.touched&&c.error})]})}),t.jsxs("div",{className:e.authFormNavigationContainer,children:[t.jsx(F,{disabled:o,onClick:()=>j(A),className:h(e.formButton,e.resetButton),children:"Reset"}),t.jsx(F,{disabled:o,onClick:()=>r(),className:h(e.formButton,e.authButton),children:"Login"})]})]})})})},et="_loginFormContainer_a82po_1",ot="_loginPageTitle_a82po_12",nt="_loginPageContainer_a82po_19",p={loginFormContainer:et,loginPageTitle:ot,loginPageContainer:nt},rt=()=>{const a=localStorage.getItem("token"),s=x(),n=O(),o=T();return b.useEffect(()=>{if(a){s(E.HOME);return}s(E.LOGIN),o({type:i.RESET_USER}),o({type:G.RESET_TODOS})},[n.pathname]),a?null:t.jsx("div",{className:p.loginPageContainer,children:t.jsxs("div",{className:p.loginFormContainer,children:[t.jsx("h4",{className:p.loginPageTitle,children:"Login"}),t.jsx(at,{})]})})};export{rt as default};
