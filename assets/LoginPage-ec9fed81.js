import{F as P,R as d,H as i,J as y,K as I,g as L,b as x,u as b,c as A,r as T,j as t,L as B,M as v,q as h,O as E,P as S,I as F,B as R,Q as M,d as H}from"./index-62392a49.js";class O{static async setLogin({email:s,password:o}){return(await P.post(`/users${d.LOGIN}`,{email:s,password:o})).data}}function G({email:a,password:s}){return async function(o){o({type:i.AUTH_PENDING,payload:!0});const n=await O.setLogin({email:a,password:s});if(typeof n=="string"){o({type:i.AUTH_ERROR,payload:n});return}o({type:i.AUTH_SUCCESS,payload:n==null?void 0:n.user}),localStorage.setItem("access-token",n.accessToken)}}var g=(a=>(a[a.MAX_PASSWORD_LENGTH=16]="MAX_PASSWORD_LENGTH",a[a.MIN_PASSWORD_LENGTH=6]="MIN_PASSWORD_LENGTH",a))(g||{}),_=(a=>(a.INVALID_EMAIL="Invalid email",a.MAX_LENGTH="Must be at most 16 characters",a.MIN_LENGTH="Must be at least 6 characters",a))(_||{});const D=y().shape({email:I().email(_.INVALID_EMAIL).required(L.REQUIRED_FIELD),password:I().max(g.MAX_PASSWORD_LENGTH,_.MAX_LENGTH).min(g.MIN_PASSWORD_LENGTH,_.MIN_LENGTH).required(L.REQUIRED_FIELD)}),z="_authForm_3zb5r_1",w="_authFieldContainer_3zb5r_6",k="_authInputContainer_3zb5r_12",U="_authFieldError_3zb5r_19",W="_authLabel_3zb5r_23",X="_authInput_3zb5r_12",$="_authFormNavigationContainer_3zb5r_39",q="_formButton_3zb5r_43",Q="_authButton_3zb5r_51",J="_resetButton_3zb5r_55",K="_testError_3zb5r_60",e={authForm:z,authFieldContainer:w,authInputContainer:k,authFieldError:U,authLabel:W,authInput:X,authFormNavigationContainer:$,formButton:q,authButton:Q,resetButton:J,testError:K},Y=()=>{const a=x(),s=b(),{error:o,isPending:n,user:m}=A(r=>r.authReducer);T.useEffect(()=>{m!=null&&m._id&&localStorage.getItem("access-token")&&s(d.HOME),a({type:i.RESET_ERROR})},[m]);const C=async r=>{a(G({...r}))},j=r=>{r(),a({type:i.RESET_ERROR})};return t.jsx("form",{className:e.authForm,children:n?t.jsx(B,{}):t.jsx(v,{initialValues:{email:"",password:""},validationSchema:D,onSubmit:C,children:({handleSubmit:r,handleBlur:N,resetForm:f})=>t.jsxs("div",{className:e.authFieldContainer,children:[t.jsx("span",{className:h(E.modalError,e.authFieldError,e.testError),children:o}),t.jsx(S,{name:"email",children:({field:l,meta:c})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"email",children:"Email"}),t.jsx(F,{...l,className:e.authInput,id:"email",type:"email",placeholder:"Email",onBlur:u=>{l.onBlur(u),N(u)}}),t.jsx("span",{className:h(E.modalError,e.authFieldError),children:c.touched&&c.error})]})}),t.jsx(S,{name:"password",children:({field:l,meta:c})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"password",children:"Password"}),t.jsx(F,{...l,className:e.authInput,type:"password",id:"password",placeholder:"Password",onBlur:u=>{l.onBlur(u),N(u)}}),t.jsx("span",{className:h(E.modalError,e.authFieldError),children:c.touched&&c.error})]})}),t.jsxs("div",{className:e.authFormNavigationContainer,children:[t.jsx(R,{disabled:n,onClick:()=>j(f),className:h(e.formButton,e.resetButton),children:"Reset"}),t.jsx(R,{disabled:n,onClick:()=>r(),className:h(e.formButton,e.authButton),children:"Login"})]})]})})})},Z="_loginFormContainer_a82po_1",V="_loginPageTitle_a82po_12",tt="_loginPageContainer_a82po_19",p={loginFormContainer:Z,loginPageTitle:V,loginPageContainer:tt},et=()=>{const a=localStorage.getItem("access-token"),s=b(),o=M(),n=x();return T.useEffect(()=>{if(a){s(d.HOME);return}s(d.LOGIN),n({type:i.RESET_USER}),n({type:H.RESET_TODOS})},[o.pathname]),a?null:t.jsx("div",{className:p.loginPageContainer,children:t.jsxs("div",{className:p.loginFormContainer,children:[t.jsx("h4",{className:p.loginPageTitle,children:"Login"}),t.jsx(Y,{})]})})};export{et as default};
