import{R as d,K as m,M as f,O as I,l as L,c as P,u as R,g as A,r as b,j as t,L as B,P as v,w as u,Q as p,S as F,I as S,B as x,U as y}from"./index-949908ae.js";import{a as M}from"./api-bcb880e2.js";class H{static async setLogin({email:s,password:n}){return(await M.post(d.LOGIN,{email:s,password:n})).data}}function O({email:a,password:s}){return async function(n){n({type:m.AUTH_PENDING,payload:!0});const o=await H.setLogin({email:a,password:s});if(typeof o=="string"){n({type:m.AUTH_ERROR,payload:o});return}n({type:m.AUTH_SUCCESS,payload:o==null?void 0:o.user}),localStorage.setItem("access-token",o.accessToken)}}var N=(a=>(a[a.MAX_PASSWORD_LENGTH=16]="MAX_PASSWORD_LENGTH",a[a.MIN_PASSWORD_LENGTH=6]="MIN_PASSWORD_LENGTH",a))(N||{}),_=(a=>(a.INVALID_EMAIL="Invalid email",a.MAX_LENGTH="Must be at most 16 characters",a.MIN_LENGTH="Must be at least 6 characters",a))(_||{});const G=f().shape({email:I().email(_.INVALID_EMAIL).required(L.REQUIRED_FIELD),password:I().max(N.MAX_PASSWORD_LENGTH,_.MAX_LENGTH).min(N.MIN_PASSWORD_LENGTH,_.MIN_LENGTH).required(L.REQUIRED_FIELD)}),w="_authForm_3zb5r_1",z="_authFieldContainer_3zb5r_6",D="_authInputContainer_3zb5r_12",k="_authFieldError_3zb5r_19",U="_authLabel_3zb5r_23",W="_authInput_3zb5r_12",X="_authFormNavigationContainer_3zb5r_39",Q="_formButton_3zb5r_43",$="_authButton_3zb5r_51",q="_resetButton_3zb5r_55",K="_testError_3zb5r_60",e={authForm:w,authFieldContainer:z,authInputContainer:D,authFieldError:k,authLabel:U,authInput:W,authFormNavigationContainer:X,formButton:Q,authButton:$,resetButton:q,testError:K},J=()=>{const a=P(),s=R(),{error:n,isPending:o,user:h}=A(r=>r.authReducer);b.useEffect(()=>{h!=null&&h._id&&localStorage.getItem("access-token")&&s(d.HOME),a({type:m.RESET_ERROR})},[h]);const C=async r=>{a(O({...r}))},j=r=>{r(),a({type:m.RESET_ERROR})};return t.jsx("form",{className:e.authForm,children:o?t.jsx(B,{}):t.jsx(v,{initialValues:{email:"",password:""},validationSchema:G,onSubmit:C,children:({handleSubmit:r,handleBlur:g,resetForm:T})=>t.jsxs("div",{className:e.authFieldContainer,children:[t.jsx("span",{className:u(p.modalError,e.authFieldError,e.testError),children:n}),t.jsx(F,{name:"email",children:({field:i,meta:l})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"email",children:"Email"}),t.jsx(S,{...i,className:e.authInput,id:"email",type:"email",placeholder:"Email",onBlur:c=>{i.onBlur(c),g(c)}}),t.jsx("span",{className:u(p.modalError,e.authFieldError),children:l.touched&&l.error})]})}),t.jsx(F,{name:"password",children:({field:i,meta:l})=>t.jsxs("fieldset",{className:e.authInputContainer,children:[t.jsx("label",{className:e.authLabel,htmlFor:"password",children:"Password"}),t.jsx(S,{...i,className:e.authInput,type:"password",id:"password",placeholder:"Password",onBlur:c=>{i.onBlur(c),g(c)}}),t.jsx("span",{className:u(p.modalError,e.authFieldError),children:l.touched&&l.error})]})}),t.jsxs("div",{className:e.authFormNavigationContainer,children:[t.jsx(x,{disabled:o,onClick:()=>j(T),className:u(e.formButton,e.resetButton),children:"Reset"}),t.jsx(x,{disabled:o,onClick:()=>r(),className:u(e.formButton,e.authButton),children:"Login"})]})]})})})},Y="_loginFormContainer_a82po_1",Z="_loginPageTitle_a82po_12",V="_loginPageContainer_a82po_19",E={loginFormContainer:Y,loginPageTitle:Z,loginPageContainer:V},et=()=>{const a=localStorage.getItem("access-token"),s=R(),n=y();return b.useEffect(()=>{s(a?d.HOME:d.LOGIN)},[n.pathname]),a?null:t.jsx("div",{className:E.loginPageContainer,children:t.jsxs("div",{className:E.loginFormContainer,children:[t.jsx("h4",{className:E.loginPageTitle,children:"Login"}),t.jsx(J,{})]})})};export{et as default};
